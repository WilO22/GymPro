<div class="container mx-auto p-4 sm:p-6 lg:p-8">

  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-slate-900">Gestión de Clases</h1>
    <button (click)="openCreateModal()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition duration-300">
      <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
      <span class="hidden sm:inline">Crear Clase</span>
    </button>
  </div>

  <div>
    @if (classes().length > 0) {
      <div>
        <div class="hidden md:grid md:grid-cols-4 bg-gray-800 px-6 py-3 rounded-t-lg">
          <h3 class="font-semibold text-gray-300 tracking-wider text-sm">Clase</h3>
          <h3 class="font-semibold text-gray-300 tracking-wider text-sm">Horario</h3>
          <h3 class="font-semibold text-gray-300 tracking-wider text-sm text-center">Ocupación</h3>
          <h3 class="font-semibold text-gray-300 tracking-wider text-sm text-center">Acciones</h3>
        </div>
        
        <div class="flex flex-col gap-4 md:gap-0">
          @for (clase of classes(); track clase.id; let isLast = $last) {
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 
                        md:bg-transparent md:shadow-none md:border-x-0 md:border-t-0 md:rounded-none
                        md:border-b md:border-gray-300">
              
              <div class="p-4 md:grid md:grid-cols-4 md:items-center md:gap-x-6 md:px-6 md:py-4">
                
                <div class="flex justify-between items-start mb-2 md:mb-0">
                  <div>
                    <div class="font-semibold text-slate-900">{{ clase.name }}</div>
                    <div class="text-sm text-slate-500">{{ clase.trainer }}</div>
                  </div>
                  <div class="flex items-center gap-1 md:hidden">
                    <button (click)="handleEdit(clase)" class="p-2 rounded-full text-slate-400 hover:text-blue-600 hover:bg-blue-100 transition-colors">
                      <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
                    </button>
                    <button (click)="handleDelete(clase.id!)" class="p-2 rounded-full text-slate-400 hover:text-red-600 hover:bg-red-100 transition-colors">
                      <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                    </button>
                  </div>
                </div>

                <div class="text-sm text-slate-600 mb-2 md:mb-0">
                  <span class="font-bold text-slate-700 md:hidden">Horario: </span>
                  {{ clase.day }} - {{ clase.time }}
                </div>

                <div class="text-sm text-slate-600 md:text-center md:font-medium">
                  <span class="font-bold text-slate-700 md:hidden">Ocupación: </span>
                  {{ clase.bookedSlots }} / {{ clase.totalSlots }}
                </div>
                
                <div class="hidden md:flex justify-center items-center gap-2">
                  <button (click)="handleEdit(clase)" class="p-2 rounded-full text-slate-400 hover:text-blue-600 hover:bg-blue-100 transition-colors">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
                  </button>
                  <button (click)="handleDelete(clase.id!)" class="p-2 rounded-full text-slate-400 hover:text-red-600 hover:bg-red-100 transition-colors">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                  </button>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    } @else {
      <div class="bg-white rounded-lg shadow-sm border border-gray-300 text-center py-16 px-6">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
        </svg>
        <h3 class="mt-2 text-xl font-semibold text-gray-900">No hay clases</h3>
        <p class="mt-1 text-sm text-gray-500">
          Comienza creando una nueva clase para que aparezca aquí.
        </p>
      </div>
    }
  </div> 
  
  @if (isModalVisible()) {
    <app-class-form 
      [classData]="classToEdit()" 
      (save)="handleSave($event)" 
      (cancel)="closeModal()">
    </app-class-form>
  }
</div>